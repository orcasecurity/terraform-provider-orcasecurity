---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "orcasecurity_automation_v2 Resource - orcasecurity"
subcategory: ""
description: |-
  Provides an automation v2 resource. This is the next generation automation system that uses Sonar queries for filtering and supports external service integrations via external configuration IDs.
---

# orcasecurity_automation_v2 (Resource)

Provides an automation v2 resource. This is the next generation automation system that uses Sonar queries for filtering and supports external service integrations via external configuration IDs.

## Example Usage

```terraform
# Basic automation v2 with Jira Cloud using external configuration
resource "orcasecurity_automation_v2" "jira_example" {
  name        = "Critical Alerts to Jira"
  description = "Send critical alerts to Jira using external config"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  jira_cloud_template = {
    external_config_id = "12345678-1234-1234-1234-123456789abc"
    parent_issue       = "SEC-123"
  }
}

# Automation with Datadog logs integration
resource "orcasecurity_automation_v2" "datadog_logs" {
  name        = "Send Alerts to Datadog Logs"
  description = "Forward security alerts to Datadog as logs"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  datadog_template = {
    external_config_id = "87654321-4321-4321-4321-cba987654321"
    type              = "LOGS"
  }
}

# Automation with Datadog events integration
resource "orcasecurity_automation_v2" "datadog_events" {
  name        = "Send Alerts to Datadog Events"
  description = "Forward security alerts to Datadog as events"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  datadog_template = {
    external_config_id = "87654321-4321-4321-4321-cba987654321"
    type              = "EVENT"
  }
}

# Automation with Slack integration using external config
resource "orcasecurity_automation_v2" "slack_example" {
  name        = "Security Alerts to Slack"
  description = "Send security alerts to Slack channel"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  slack_template = {
    external_config_id = "11111111-2222-3333-4444-555555555555"
  }
}

# Automation with Sumo Logic using external config
resource "orcasecurity_automation_v2" "sumo_logic_example" {
  name        = "Forward to Sumo Logic"
  description = "Send alerts to Sumo Logic for analysis"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  sumo_logic_template = {
    external_config_id = "test-sumo-config-uuid"
  }
}

# Automation with Azure Sentinel using external config
resource "orcasecurity_automation_v2" "azure_sentinel_example" {
  name        = "Forward to Azure Sentinel"
  description = "Send alerts to Azure Sentinel for SIEM analysis"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  azure_sentinel_template = {
    external_config_id = "test-azure-sentinel-uuid"
  }
}

# Automation with email notifications
resource "orcasecurity_automation_v2" "email_example" {
  name        = "Email Security Team"
  description = "Send critical alerts to security team via email"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  email_template = {
    email        = ["security@company.com", "admin@company.com"]
    multi_alerts = true
  }
}

# Automation with snooze action
resource "orcasecurity_automation_v2" "snooze_example" {
  name        = "Auto-snooze Test Alerts"
  description = "Automatically snooze alerts from test environments"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  snooze_template = {
    days          = 7
    reason        = "Test Environment"
    justification = "These alerts are from test environments and can be snoozed"
  }
}

# Automation with webhook integration
resource "orcasecurity_automation_v2" "webhook_example" {
  name        = "Custom Webhook Integration"
  description = "Send alerts to custom webhook endpoint"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  webhook_template = {
    external_config_id = "test-webhook-config-uuid"
  }
}

# Automation with end time (temporary automation)
resource "orcasecurity_automation_v2" "temporary_example" {
  name        = "Temporary Alert Forwarding"
  description = "Forward alerts during incident response period"
  status      = "enabled"
  end_time    = "2024-12-31T23:59:59Z"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  email_template = {
    email        = ["incident-response@company.com"]
    multi_alerts = false
  }
}

# Advanced automation with complex sonar query filtering
resource "orcasecurity_automation_v2" "advanced_filtering" {
  name        = "Advanced Alert Filtering"
  description = "Complex filtering for specific alert types, scores, and cloud providers"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
      with = {
        operator = "and"
        type     = "operation"
        values = [
          {
            key      = "AlertType"
            operator = "in"
            type     = "str"
            values = [
              "AWS EC2 instance allows public ingress access on NetBIOS port 137",
              "S3 bucket data is not protected",
              "SQS queue with public access",
              "Azure SQL Database with basic sku"
            ]
          },
          {
            key      = "OrcaScore"
            operator = "range"
            type     = "float"
            values   = [7, 10]
          },
          {
            keys     = ["CloudAccount"]
            models   = ["CloudAccount"]
            operator = "has"
            type     = "object"
            with = {
              key      = "CloudProvider"
              operator = "in"
              type     = "str"
              values   = ["aws", "azure"]
            }
          },
          {
            keys     = ["Inventories"]
            models   = ["Inventory"]
            operator = "has"
            type     = "object_set"
          }
        ]
      }
    })
  }

  slack_template = {
    external_config_id = "11111111-2222-3333-4444-555555555555"
  }
}

# Automation with multiple external service templates
resource "orcasecurity_automation_v2" "comprehensive_example" {
  name        = "Multi-Service Integration"
  description = "Forward alerts to multiple services"
  status      = "enabled"

  filter = {
    sonar_query = jsonencode({
      models = ["Alert"]
      type   = "object_set"
    })
  }

  # Communication services
  opsgenie_template = {
    external_config_id = "33333333-4444-5555-6666-777777777777"
  }

  ms_teams_template = {
    external_config_id = "11111111-2222-3333-4444-555555555555"
  }

  # SIEM services
  splunk_template = {
    external_config_id = "44444444-5555-6666-7777-888888888888"
  }

  aws_security_hub_template = {
    external_config_id = "55555555-6666-7777-8888-999999999999"
  }

  # Ticketing services
  servicenow_incidents_template = {
    external_config_id = "66666666-7777-8888-9999-aaaaaaaaaaaa"
  }

  monday_template = {
    external_config_id = "gggggggg-hhhh-iiii-jjjj-kkkkkkkkkkkk"
  }

  # Cloud services
  aws_sqs_template = {
    external_config_id = "bbbbbbbb-cccc-dddd-eeee-ffffffffffff"
  }

  aws_sns_template = {
    external_config_id = "cccccccc-dddd-eeee-ffff-gggggggggggg"
  }

  gcp_pub_sub_template = {
    external_config_id = "dddddddd-eeee-ffff-gggg-hhhhhhhhhhhh"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `filter` (Attributes) The Sonar query filter that selects the alerts this automation applies to. (see [below for nested schema](#nestedatt--filter))
- `name` (String) Automation name.
- `status` (String) Automation status. Valid values: `enabled`, `disabled`.

### Optional

- `aws_security_hub_template` (Attributes) AWS Security Hub integration template. (see [below for nested schema](#nestedatt--aws_security_hub_template))
- `aws_security_lake_template` (Attributes) AWS Security Lake integration template. (see [below for nested schema](#nestedatt--aws_security_lake_template))
- `aws_sns_template` (Attributes) AWS SNS integration template. (see [below for nested schema](#nestedatt--aws_sns_template))
- `aws_sqs_template` (Attributes) AWS SQS integration template. (see [below for nested schema](#nestedatt--aws_sqs_template))
- `azure_devops_template` (Attributes) Azure DevOps integration template. (see [below for nested schema](#nestedatt--azure_devops_template))
- `azure_sentinel_template` (Attributes) Azure Sentinel integration template. (see [below for nested schema](#nestedatt--azure_sentinel_template))
- `chronicle_template` (Attributes) Chronicle integration template. (see [below for nested schema](#nestedatt--chronicle_template))
- `cribl_template` (Attributes) Cribl integration template. (see [below for nested schema](#nestedatt--cribl_template))
- `datadog_template` (Attributes) Datadog integration template. (see [below for nested schema](#nestedatt--datadog_template))
- `description` (String) Automation description.
- `email_template` (Attributes) Email notification template. (see [below for nested schema](#nestedatt--email_template))
- `end_time` (String) Optional end time for the automation in RFC3339 format (e.g., '2024-12-31T23:59:59Z'). The automation will be automatically disabled after this time.
- `gcp_pub_sub_template` (Attributes) GCP Pub/Sub integration template. (see [below for nested schema](#nestedatt--gcp_pub_sub_template))
- `jira_cloud_template` (Attributes) Jira Cloud integration template. (see [below for nested schema](#nestedatt--jira_cloud_template))
- `jira_server_template` (Attributes) Jira Server integration template. (see [below for nested schema](#nestedatt--jira_server_template))
- `linear_template` (Attributes) Linear integration template. (see [below for nested schema](#nestedatt--linear_template))
- `monday_template` (Attributes) Monday.com integration template. (see [below for nested schema](#nestedatt--monday_template))
- `ms_teams_template` (Attributes) Microsoft Teams integration template. (see [below for nested schema](#nestedatt--ms_teams_template))
- `opsgenie_template` (Attributes) Opsgenie integration template. (see [below for nested schema](#nestedatt--opsgenie_template))
- `pager_duty_template` (Attributes) PagerDuty integration template. (see [below for nested schema](#nestedatt--pager_duty_template))
- `panther_template` (Attributes) Panther integration template. (see [below for nested schema](#nestedatt--panther_template))
- `servicenow_incidents_template` (Attributes) ServiceNow Incidents integration template. (see [below for nested schema](#nestedatt--servicenow_incidents_template))
- `servicenow_si_incidents_template` (Attributes) ServiceNow Security Incidents integration template. (see [below for nested schema](#nestedatt--servicenow_si_incidents_template))
- `slack_template` (Attributes) Slack integration template. (see [below for nested schema](#nestedatt--slack_template))
- `snooze_template` (Attributes) Snooze action template. (see [below for nested schema](#nestedatt--snooze_template))
- `snowflake_template` (Attributes) Snowflake integration template. (see [below for nested schema](#nestedatt--snowflake_template))
- `splunk_template` (Attributes) Splunk integration template. (see [below for nested schema](#nestedatt--splunk_template))
- `sumo_logic_template` (Attributes) Sumo Logic integration template. (see [below for nested schema](#nestedatt--sumo_logic_template))
- `tines_template` (Attributes) Tines integration template. (see [below for nested schema](#nestedatt--tines_template))
- `torq_template` (Attributes) Torq integration template. (see [below for nested schema](#nestedatt--torq_template))
- `webhook_template` (Attributes) Webhook integration template. (see [below for nested schema](#nestedatt--webhook_template))

### Read-Only

- `id` (String) Automation ID.
- `organization_id` (String) Organization ID that this automation belongs to.

<a id="nestedatt--filter"></a>
### Nested Schema for `filter`

Required:

- `sonar_query` (String) Sonar query in JSON format that defines which alerts this automation applies to. Must be valid JSON containing at minimum 'models' and 'type' fields.

<a id="nestedatt--aws_security_hub_template"></a>
### Nested Schema for `aws_security_hub_template`

Required:

- `external_config_id` (String) External configuration ID for the AWS Security Hub integration.

<a id="nestedatt--aws_security_lake_template"></a>
### Nested Schema for `aws_security_lake_template`

Required:

- `external_config_id` (String) External configuration ID for the AWS Security Lake integration.

<a id="nestedatt--aws_sns_template"></a>
### Nested Schema for `aws_sns_template`

Required:

- `external_config_id` (String) External configuration ID for the AWS SNS integration.

<a id="nestedatt--aws_sqs_template"></a>
### Nested Schema for `aws_sqs_template`

Required:

- `external_config_id` (String) External configuration ID for the AWS SQS integration.

<a id="nestedatt--azure_devops_template"></a>
### Nested Schema for `azure_devops_template`

Required:

- `external_config_id` (String) External configuration ID for the Azure DevOps integration.

<a id="nestedatt--azure_sentinel_template"></a>
### Nested Schema for `azure_sentinel_template`

Required:

- `external_config_id` (String) External configuration ID for the Azure Sentinel integration.

<a id="nestedatt--chronicle_template"></a>
### Nested Schema for `chronicle_template`

Required:

- `external_config_id` (String) External configuration ID for the Chronicle integration.

<a id="nestedatt--cribl_template"></a>
### Nested Schema for `cribl_template`

Required:

- `external_config_id` (String) External configuration ID for the Cribl integration.

<a id="nestedatt--datadog_template"></a>
### Nested Schema for `datadog_template`

Required:

- `external_config_id` (String) External configuration ID for the Datadog integration.
- `type` (String) Type of Datadog integration. Valid values: `LOGS`, `EVENT`.

<a id="nestedatt--email_template"></a>
### Nested Schema for `email_template`

Required:

- `email` (List of String) List of email addresses to send notifications to.
- `multi_alerts` (Boolean) If true, multiple alerts will be aggregated into a single email. If false, each alert will generate a separate email.

<a id="nestedatt--gcp_pub_sub_template"></a>
### Nested Schema for `gcp_pub_sub_template`

Required:

- `external_config_id` (String) External configuration ID for the GCP Pub/Sub integration.

<a id="nestedatt--jira_cloud_template"></a>
### Nested Schema for `jira_cloud_template`

Required:

- `external_config_id` (String) External configuration ID for the Jira Cloud integration.

Optional:

- `parent_issue` (String) Parent issue key to create sub-tasks under (e.g., 'SEC-123').

<a id="nestedatt--jira_server_template"></a>
### Nested Schema for `jira_server_template`

Required:

- `external_config_id` (String) External configuration ID for the Jira Server integration.

<a id="nestedatt--linear_template"></a>
### Nested Schema for `linear_template`

Required:

- `external_config_id` (String) External configuration ID for the Linear integration.

<a id="nestedatt--monday_template"></a>
### Nested Schema for `monday_template`

Required:

- `external_config_id` (String) External configuration ID for the Monday.com integration.

<a id="nestedatt--ms_teams_template"></a>
### Nested Schema for `ms_teams_template`

Required:

- `external_config_id` (String) External configuration ID for the Microsoft Teams integration.

<a id="nestedatt--opsgenie_template"></a>
### Nested Schema for `opsgenie_template`

Required:

- `external_config_id` (String) External configuration ID for the Opsgenie integration.

<a id="nestedatt--pager_duty_template"></a>
### Nested Schema for `pager_duty_template`

Required:

- `external_config_id` (String) External configuration ID for the PagerDuty integration.

<a id="nestedatt--panther_template"></a>
### Nested Schema for `panther_template`

Required:

- `external_config_id` (String) External configuration ID for the Panther integration.

<a id="nestedatt--servicenow_incidents_template"></a>
### Nested Schema for `servicenow_incidents_template`

Required:

- `external_config_id` (String) External configuration ID for the ServiceNow Incidents integration.

<a id="nestedatt--servicenow_si_incidents_template"></a>
### Nested Schema for `servicenow_si_incidents_template`

Required:

- `external_config_id` (String) External configuration ID for the ServiceNow Security Incidents integration.

<a id="nestedatt--slack_template"></a>
### Nested Schema for `slack_template`

Required:

- `external_config_id` (String) External configuration ID for the Slack integration.

<a id="nestedatt--snooze_template"></a>
### Nested Schema for `snooze_template`

Required:

- `days` (Number) Number of days to snooze the alerts for.
- `justification` (String) Detailed justification for why the alerts are being snoozed.
- `reason` (String) Reason for snoozing the alerts.

<a id="nestedatt--snowflake_template"></a>
### Nested Schema for `snowflake_template`

Required:

- `external_config_id` (String) External configuration ID for the Snowflake integration.

<a id="nestedatt--splunk_template"></a>
### Nested Schema for `splunk_template`

Required:

- `external_config_id` (String) External configuration ID for the Splunk integration.

<a id="nestedatt--sumo_logic_template"></a>
### Nested Schema for `sumo_logic_template`

Required:

- `external_config_id` (String) External configuration ID for the Sumo Logic integration.

<a id="nestedatt--tines_template"></a>
### Nested Schema for `tines_template`

Required:

- `external_config_id` (String) External configuration ID for the Tines integration.

<a id="nestedatt--torq_template"></a>
### Nested Schema for `torq_template`

Required:

- `external_config_id` (String) External configuration ID for the Torq integration.

<a id="nestedatt--webhook_template"></a>
### Nested Schema for `webhook_template`

Required:

- `external_config_id` (String) External configuration ID for the Webhook integration.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import orcasecurity_automation_v2.example AUTOMATION_ID
```