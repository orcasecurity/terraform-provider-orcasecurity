---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "orcasecurity_custom_discovery_alert Resource - orcasecurity"
subcategory: ""
description: |-
  Provides a custom discovery-based alert.
---

# orcasecurity_custom_discovery_alert (Resource)

Provides a custom discovery-based alert.

## Example Usage

```terraform
# simple discovery-based custom alert
resource "orcasecurity_custom_discovery_alert" "alert_discovery" {
  name          = "Azure VNets that aren't in use"
  description   = "Azure VNets that don't have any compute or data resources attached to them via NICs."
  rule_json     = jsonencode({ "models" : ["AzureVNet"], "type" : "object_set", "with" : { "models" : ["AzureNetworkInterface"], "type" : "object_set", "keys" : ["NetworkInterfaces"], "operator" : "has", "negate" : true } })
  orca_score    = 6.2
  category      = "Network misconfigurations"
  context_score = false
}

# discovery-based custom alert with remediation steps
resource "orcasecurity_custom_discovery_alert" "example" {
  name          = "Azure VNets that aren't in use"
  description   = "Azure VNets that don't have any compute or data resources attached to them via NICs."
  rule_json     = jsonencode({ "models" : ["AzureVNet"], "type" : "object_set", "with" : { "models" : ["AzureNetworkInterface"], "type" : "object_set", "keys" : ["NetworkInterfaces"], "operator" : "has", "negate" : true } })
  orca_score    = 6.2
  category      = "Network misconfigurations"
  context_score = false
  remediation_text = {
    enable = true
    text   = "Add resources to this VNet via a network interface or delete this VNet."
  }
}

# discovery-based custom alert with custom compliance frameworks associations
resource "orcasecurity_custom_discovery_alert" "example" {
  name          = "Azure VNets that aren't in use"
  description   = "Azure VNets that don't have any compute or data resources attached to them via NICs."
  rule_json     = jsonencode({ "models" : ["AzureVNet"], "type" : "object_set", "with" : { "models" : ["AzureNetworkInterface"], "type" : "object_set", "keys" : ["NetworkInterfaces"], "operator" : "has", "negate" : true } })
  orca_score    = 6.2
  category      = "Network misconfigurations"
  context_score = false
  compliance_frameworks = [
    { name = "framework 1 name", section = "framework 1 section", priority = "low" },
    { name = "framework 2 name", section = "framework 2 section", priority = "medium" }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `category` (String) Alert category. Valid values are `Access control`, `Authentication`, `Best practices`, `Data at risk`, `Data protection`, `IAM misconfigurations`, `Lateral movement`, `Logging and monitoring`, `Malicious activity`, `Malware`, `Neglected assets`, `Network misconfigurations`, `Source code vulnerabilities`, `Suspicious activity`, `System integrity`, `Vendor services misconfigurations`, `Vulnerabilities`, and `Workload misconfigurations`.
- `context_score` (Boolean) Allows Orca to adjust the score using asset context.
- `name` (String) Custom alert name.
- `orca_score` (Number) The base score of the alert.

### Optional

- `compliance_frameworks` (Attributes List) The custom compliance framework(s) that this alert relates to. In the context of a compliance framework, alerts correspond to controls. (see [below for nested schema](#nestedatt--compliance_frameworks))
- `description` (String) Custom alert description.
- `remediation_text` (Attributes) A container for the remediation instructions that will appear on the 'Remediation' tab for the alert. (see [below for nested schema](#nestedatt--remediation_text))
- `rule_json` (String) The discovery query (JSON) used to define the rule.

### Read-Only

- `id` (String) Custom alert ID.
- `organization_id` (String) Orca organization ID.
- `rule_type` (String) Custom alert rule type (unique, Orca-computed identifier).

<a id="nestedatt--compliance_frameworks"></a>
### Nested Schema for `compliance_frameworks`

Required:

- `name` (String) Custom framework name.
- `priority` (String) Custom framework control priority. Valid values are `high`, `medium`, and `low`.
- `section` (String) Custom framework section.


<a id="nestedatt--remediation_text"></a>
### Nested Schema for `remediation_text`

Required:

- `text` (String) Remediation description.

Optional:

- `enable` (Boolean) Whether or not all users are able to see the remediation instructions for this alert. To enable all users to see them, set this to `true`.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
//import NOT supported yet as of December 21st, 2024.
terraform import orcasecurity_custom_discovery_alert.example RULE_ID
```
